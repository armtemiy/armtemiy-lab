# Armtemiy Lab — контекст для deep-research

## 1) Что это

Telegram Mini App (TMA) для "умных новичков" в армрестлинге. MVP — логическая экспертная система (decision tree) для быстрой диагностики поражений и рекомендаций.

Название: **Armtemiy Lab**
Платформа: Telegram WebApp (Mini App)
Деплой: GitHub Pages (статический фронтенд) + Supabase (данные и Edge Functions)

## 2) Почему так

В рамках ниши и бюджета видеоанализ нерентабелен. Логическая экспертная система быстро дает ощущение "умной" диагностики и совпадает с когнитивным профилем аудитории.

## 3) Основные модули (текущее состояние)

1. **Диагностика поражения** (основной модуль)
   - Визард из вопросов → диагноз → рекомендации
   - Работает через дерево решений (JSON)
   - Есть премиум-ветки и тест оплаты
   - Результаты сохраняются в Supabase (`diagnostic_results`)

2. **Антропометрия** (черновой калькулятор)
   - Ввод: предплечье, ладонь, запястье
   - Вывод: рекомендация стиля (Toproll/Hook/Press)
   - Логика эвристическая, временная

3. **Контр-матрица**
   - Логика: верх > крюк, крюк > пресс, пресс > верх

4. **Админ-модуль** (без Supabase)
   - Загрузка/экспорт JSON дерева
   - Хранение локально через `localStorage`
   - Сброс на дефолт

## 4) Текущее состояние оплаты

- Инвойсы Telegram Stars создаются и открываются в WebApp.
- Оплата может зависать на стороне Telegram/сети (не баг приложения).
- Есть fallback: открытие invoice link через Telegram.

## 5) Инфраструктура

Frontend:
- React + Vite + TypeScript
- Tailwind v4
- Framer Motion
- Telegram SDK (`@tma.js/sdk`)

Backend:
- Supabase (Postgres)
- Supabase Edge Function: `create-stars-invoice`

## 6) Данные и логика

Дерево решений — JSON-структура:
- `id`, `title`, `start`, `nodes`
- Узлы `question` с `options`
- Узлы `result` с `diagnosis`, `recommendations`, `premium`

Шаблон дерева для теста:
- `assets/diagnostic-template.json`

## 7) Таблицы Supabase

- `users`
- `diagnostic_trees`
- `diagnostic_results`
- `purchases`

Миграция:
- `supabase/migrations/20260124150013_init-schema.sql`

## 8) Где что лежит в коде

- UI и навигация: `src/App.tsx`
- Диагностика: `src/modules/DiagnosticWizard.tsx`
- Антропометрия: `src/modules/AnthroModule.tsx`
- Контр-матрица: `src/modules/CounterModule.tsx`
- Админ: `src/modules/AdminModule.tsx`
- Шаблон дерева: `assets/diagnostic-template.json`
- Палитра: `COLOR-PALETTE.md`

## 9) Дизайн

Палитра: "The Underground Forge" — красный/черный, высокий контраст, агрессия. Реализована в `src/index.css` через токены.

## 10) Что нужно улучшать дальше (направления)

1. Экспертное дерево (реальные ветки и формулировки)
2. Валидация JSON дерева в админке (минимальный schema check)
3. История/версии дерева (локально или в Supabase)
4. UX: быстрые ответы, сокращение кликов, умные подсказки
5. Платежи: опционально callback через бота

## 11) Вопросы для deep-research

1. Как улучшить диагностическое дерево: структура, длина, подход к ветвлению?
2. Как ускорить onboarding (меньше вопросов, выше точность)?
3. Как сделать антропометрию более обоснованной?
4. Какой контент в премиум-ветках дает максимальную ценность?
5. Какие игровые механики лучше удерживают "умных новичков"?
